"use strict";(self.webpackChunkhealth_monitor=self.webpackChunkhealth_monitor||[]).push([[521],{1695:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var a=n(89379),r=n(65043),s=n(19095),i=n(72952),l=n(35475);function c(e){return["Su","Mo","Tu","We","Th","Fr","Sa"][e]}var o=n(18781),d=n(86178),u=n.n(d);const m="AlertForm_formModalCont__X+ecJ",y="AlertForm_form__3yYVH",_="AlertForm_close__sNrIJ",h="AlertForm_inputGroup__HoSLd",p="AlertForm_weekly__DWHvO",g="AlertForm_checkboxLabel__k8Uno",f="AlertForm_smallBtn__wGYRD",x="AlertForm_buttonGroup__OOApd",v="AlertForm_saveBtn__JcQNo",A="AlertForm_cancelBtn__U0ivJ";var j=n(70579);const N=["Mo","Tu","We","Th","Fr","Sa","Su"],b=new Date,S="".concat(b.getFullYear(),"-").concat(String(b.getMonth()+1).padStart(2,"0"),"-").concat(String(b.getDate()).padStart(2,"0"));function D(e){let{onClose:t,handleSubmit:n,data:s,editId:i}=e;const l=(0,r.useRef)(),[c,o]=(0,r.useState)(()=>"daily"===s.frequency?"daily":"string"===typeof s.frequency&&s.frequency.includes("monthly")?"monthly":"string"===typeof s.frequency&&/^\d{4}-\d{2}-\d{2}$/.test(s.frequency)?"date":(Array.isArray(s.frequency),"weekly")),[d,u]=(0,r.useState)(Array.isArray(s.frequency)?[...s.frequency]:[]),[b,D]=(0,r.useState)((0,a.A)((0,a.A)({},s),{},{frequency:s.frequency})),[q,C]=(0,r.useState)(S);(0,r.useEffect)(()=>{document.body.style.overflow="hidden";const e=e=>{"Escape"===e.key&&t()};return document.addEventListener("keydown",e),()=>{document.body.style.overflow="auto",document.removeEventListener("keydown",e)}},[t]),(0,r.useEffect)(()=>{Array.isArray(s.frequency)&&u([...s.frequency])},[s.frequency]);const k=(e,t)=>{D(n=>(0,a.A)((0,a.A)({},n),{},{[e]:t}))},w="alert"===b.type||"metrix"===b.type;return(0,j.jsx)("div",{ref:l,onClick:e=>{e.currentTarget===e.target&&t()},className:m,children:(0,j.jsxs)("form",{className:y,onSubmit:e=>{let t;e.preventDefault(),t="daily"===c?"daily":"weekly"===c?d:"monthly"===c?b.frequency:"date"===c?q:b.frequency;const r=(0,a.A)((0,a.A)({},b),{},{frequency:t});n(r)},children:[(0,j.jsx)("button",{className:_,onClick:t,type:"button",children:"x"}),w&&(0,j.jsxs)("div",{className:h,children:[(0,j.jsx)("label",{children:"Reminder Text"}),(0,j.jsx)("input",{type:"text",placeholder:"Enter reminder",value:b.text,onChange:e=>k("text",e.target.value),required:!0})]}),(0,j.jsxs)("div",{className:h,children:[(0,j.jsx)("label",{children:"Time"}),(0,j.jsx)("input",{type:"time",value:b.time,onChange:e=>k("time",e.target.value),required:!0})]}),w&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:h,children:[(0,j.jsx)("label",{children:"Frequency"}),(0,j.jsxs)("select",{value:c,onChange:e=>{o(e.target.value),"daily"===e.target.value&&k("frequency","daily"),"weekly"===e.target.value&&k("frequency",[])},children:[(0,j.jsx)("option",{value:"daily",children:"Daily"}),(0,j.jsx)("option",{value:"weekly",children:"Weekly (choose days)"}),(0,j.jsx)("option",{value:"monthly",children:"Monthly (choose day)"}),(0,j.jsx)("option",{value:"date",children:"Specific Date"})]})]}),"weekly"===c&&(0,j.jsxs)("div",{className:p,children:[N.map(e=>(0,j.jsxs)("label",{className:g,children:[(0,j.jsx)("input",{type:"checkbox",checked:d.includes(e),onChange:()=>(e=>{let t=d.includes(e)?d.filter(t=>t!==e):[...d,e];7===t.length?(o("daily"),u([]),k("frequency","daily")):(u(t),k("frequency",t))})(e)}),e]},e)),(0,j.jsx)("button",{type:"button",className:f,onClick:()=>{o("daily"),u([]),k("frequency","daily")},children:"All"})]}),"monthly"===c&&(0,j.jsxs)("div",{className:h,children:[(0,j.jsx)("label",{children:"Day of Month"}),(0,j.jsx)("input",{type:"number",min:1,max:31,step:1,value:parseInt(b.frequency)||"",onChange:e=>{return t=parseInt(e.target.value),k("frequency","".concat(t," monthly"));var t}})]}),"date"===c&&(0,j.jsxs)("div",{className:h,children:[(0,j.jsx)("label",{children:"Specific Date"}),(0,j.jsx)("input",{style:{color:"blue",fontWeight:"bold"},type:"date",min:S,value:/^\d{4}-\d{2}-\d{2}$/.test(b.frequency)?b.frequency:q,onChange:e=>{var t;t=e.target.value,k("frequency",t),C(e.target.value)}})]})]}),(0,j.jsxs)("div",{className:h,children:[(0,j.jsx)("label",{children:"Repeat Interval (hours)"}),(0,j.jsx)("input",{type:"number",min:1,max:12,step:1,value:"noRepeat"===b.repeat?"":parseInt(b.repeat)||"",onChange:e=>{const t=parseInt(e.target.value);isNaN(t)||t<1?k("repeat","noRepeat"):k("repeat",1===t?"1 hour":"".concat(t," hours"))},placeholder:"No Repeat"})]}),(0,j.jsxs)("div",{className:x,children:[(0,j.jsx)("button",{type:"submit",className:v,children:i?"Update Reminder":"Add Reminder"}),(0,j.jsx)("button",{type:"button",onClick:t,className:A,children:"Cancel"})]})]})})}var q=n(58387);const C={cont:"AlertsPage_cont__lgJvS",leftSideCont:"AlertsPage_leftSideCont__gIQ7C",rightSideCont:"AlertsPage_rightSideCont__oKjoy",title:"AlertsPage_title__KTUfV",rightSideTitle:"AlertsPage_rightSideTitle__YCVDo",headerBox:"AlertsPage_headerBox__JBWjY",addBtn:"AlertsPage_addBtn__J3uL2",main:"AlertsPage_main__wReC7",calendarBox:"AlertsPage_calendarBox__wJjzh",calendar:"AlertsPage_calendar__UjQk9","rbc-today":"AlertsPage_rbc-today__aKeVA","rbc-time-slot":"AlertsPage_rbc-time-slot__qKvOI","rbc-event":"AlertsPage_rbc-event__Nw98E",remindersList:"AlertsPage_remindersList__uqaaM",reminderItem:"AlertsPage_reminderItem__BsyI4",closeBtn:"AlertsPage_closeBtn__6SHjn",reminderItemDetailsCont:"AlertsPage_reminderItemDetailsCont__Smfyq",actions:"AlertsPage_actions__FN567",insideActions:"AlertsPage_insideActions__Z9QzG",link:"AlertsPage_link__LwdCK",stopBtn:"AlertsPage_stopBtn__1N13F",goBtn:"AlertsPage_goBtn__kF1nZ",startBtn:"AlertsPage_startBtn__q5+1t",doneBtn:"AlertsPage_doneBtn__el0Zj",editBtn:"AlertsPage_editBtn__utlnh",doneLabel:"AlertsPage_doneLabel__RMzO+"};n(83656);const k=(0,o.ye)(u());const w=function(){const{user:e,privateDispatch:t}=(0,s.d)(),[n,d]=(0,r.useState)(!1),[u,m]=(0,r.useState)(null),[y,_]=(0,r.useState)({text:"",time:"",frequency:"daily",repeat:"noRepeat",end:"23:00",type:"alert",active:!1,doneDates:[]}),h=(0,r.useMemo)(()=>[...[...(null===e||void 0===e?void 0:e.reminders)||[]].sort((e,t)=>{const[n,a]=e.time.split(":").map(Number),[r,s]=t.time.split(":").map(Number);return n!==r?n-r:a-s})],[e.reminders]),[p,g]=(0,r.useState)([]),f=e=>t((0,i.Oh)(e)),x=()=>{d(!1),m(null),_({text:"",time:"",frequency:"daily",repeat:"noRepeat",end:"23:00",type:"alert",active:!1,doneDates:[]})},v=e=>h.forEach(t=>{if(t._id===e){const e=t.doneDates?[...t.doneDates]:[],n=new Date,r=n.toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}).split(".").reverse().join("-")+" ".concat(String(n.getHours()).padStart(2,"0"),":").concat(String(n.getMinutes()).padStart(2,"0"));e.includes(r)||e.push(r),f((0,a.A)((0,a.A)({},t),{},{id:t._id,doneDates:e}))}});return(0,r.useEffect)(()=>{const e=setInterval(()=>{g(e=>[...e]),_(e=>(0,a.A)({},e))},36e5);return()=>clearInterval(e)},[]),(0,j.jsxs)("div",{className:C.cont,children:[n&&(0,j.jsx)(D,{onClose:x,handleSubmit:e=>{e.text&&e.time?(f((0,a.A)((0,a.A)({},e),{},{id:u||void 0})),x()):alert("Please enter a reminder text and time.")},data:y,handleSet:(e,t)=>_(n=>(0,a.A)((0,a.A)({},n),{},{[e]:t})),editId:u}),(0,j.jsxs)("div",{className:C.leftSideCont,children:[(0,j.jsxs)("div",{className:C.headerBox,children:[(0,j.jsx)("h1",{className:C.title,children:"Calendar"}),(0,j.jsx)("button",{onClick:()=>d(!0),className:C.addBtn,children:"+ Add Reminder"})]}),(0,j.jsx)("div",{className:C.calendarBox,children:(0,j.jsx)(o.Vv,{localizer:k,events:p,startAccessor:"start",endAccessor:"end",className:C.calendar,defaultView:"week",defaultDate:new Date,onRangeChange:e=>{let t,n;Array.isArray(e)?(t=e[0],n=e[e.length-1]):(t=e.start,n=e.end);const a=new Date;a.setHours(0,0,0,0);const r=h.filter(e=>e.active).flatMap(e=>function(e,t,n){if(!e.active)return[];const[a,r]=e.time.split(":").map(Number),[s,i]=e.end?e.end.split(":").map(Number):[a+1,r],l=[],o=e.doneDates||[];let d=0;"string"===typeof e.repeat&&"noRepeat"!==e.repeat&&(d=parseInt(e.repeat,10)),(isNaN(d)||d<1)&&(d=0);const u=new Date;u.setHours(0,0,0,0);const m=new Date(t);for(;m<=n;){const t=m.getDay(),n=m.toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}).split(".").reverse().join("-");if(m<u){m.setDate(m.getDate()+1);continue}const y=()=>{const t=new Date(m);t.setHours(a,r,0,0);const n=new Date(m);if(n.setHours(s,i,0,0),d>0){let a=new Date(t);for(;a<n;){const t=new Date(a);t.setMinutes(t.getMinutes()+1),l.push({id:"".concat(e._id,"-").concat(+a),title:e.text,start:new Date(a),end:new Date(t)}),a.setHours(a.getHours()+d)}}else l.push({id:"".concat(e._id,"-").concat(+t),title:e.text,start:t,end:n})};if("daily"!==e.frequency||o.includes(n)||y(),Array.isArray(e.frequency)&&e.frequency.includes(c(t))&&(o.includes(n)||y()),"string"===typeof e.frequency&&e.frequency.includes("monthly")){const t=parseInt(e.frequency,10);m.getDate()!==t||o.includes(n)||y()}if(/^\d{4}-\d{2}-\d{2}$/.test(e.frequency)){const[t,a,r]=e.frequency.split("-").map(Number);m.getFullYear()!==t||m.getMonth()!==a-1||m.getDate()!==r||o.includes(n)||y()}m.setDate(m.getDate()+1)}return l}(e,t,n)).filter(e=>e.start>=a);g(r)}})})]}),(0,j.jsxs)("div",{className:C.rightSideCont,children:[(0,j.jsx)("h1",{className:(0,q.A)(C.title,C.rightSideTitle),children:"Reminders"}),(0,j.jsx)("ul",{className:C.remindersList,children:h.map(e=>{var n;const r=new Date,s=r.toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}).split(".").reverse().join("-")+" ".concat(String(r.getHours()).padStart(2,"0"),":").concat(String(r.getMinutes()).padStart(2,"0")),c=null===(n=e.doneDates)||void 0===n?void 0:n.some(e=>e.split(" ")[0]===s.split(" ")[0]);return(0,j.jsxs)("li",{className:C.reminderItem,children:["alert"===e.type&&(0,j.jsx)("button",{type:"button",className:C.closeBtn,onClick:()=>{return n=e._id,t((0,i.sV)({id:n}));var n},children:"x"}),(0,j.jsxs)("div",{className:C.reminderItemDetailsCont,children:[(0,j.jsxs)("span",{className:C.text,children:[e.text," :"]}),(0,j.jsxs)("div",{className:C.timeCont,children:[(0,j.jsx)("span",{className:C.time,children:e.time}),"/",(0,j.jsx)("span",{className:C.repeat,children:Array.isArray(e.frequency)?e.frequency.join(","):e.frequency}),"noRepeat"!==e.repeat&&(0,j.jsxs)("span",{className:C.repeat,children:["/",e.repeat]})]})]}),(0,j.jsxs)("div",{className:C.actions,children:[(0,j.jsxs)("div",{className:C.insideActions,children:[(0,j.jsx)("button",{className:(0,q.A)(e.active?C.stopBtn:C.startBtn),onClick:()=>{return e.active?(t=e._id,h.forEach(e=>e._id===t&&f((0,a.A)((0,a.A)({},e),{},{id:e._id,active:!1})))):(e=>h.forEach(t=>t._id===e&&f((0,a.A)((0,a.A)({},t),{},{id:t._id,active:!0}))))(e._id);var t},children:e.active?"Stop":"Start"}),e.link&&e.active&&!c&&(0,j.jsx)(l.N_,{className:C.link,to:e.link,children:(0,j.jsx)("button",{className:C.goBtn,onClick:()=>{return t=e._id,h.forEach(e=>e._id===t?v(t):null);var t},children:"Go"})})]}),(0,j.jsxs)("div",{className:C.insideActions,children:[e.active&&(e.done||c?(0,j.jsx)("span",{style:{color:"green",fontWeight:"600",display:"flex",alignItems:"center",fontSize:"clamp(11px, 1.5vw, 13px)"},children:"\u2714 Done"}):(0,j.jsx)("button",{className:C.doneBtn,onClick:()=>v(e._id),children:"Done"})),(0,j.jsx)("button",{className:C.editBtn,onClick:()=>{d(!0),_((0,a.A)((0,a.A)({},e),{},{doneDates:e.doneDates||[]})),m(e._id)},children:"Edit"})]})]})]},"alerts-".concat(e._id))})})]})]})}}}]);
//# sourceMappingURL=521.ca1d43bc.chunk.js.map